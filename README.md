# Symbolic Calculator
Проект «Символьный Калькулятор» — это десктопное приложение (в консольной и графической версии), написанное на языке Python.
Его предназначение — численные и символьные вычисления.
Приложение фактически устроенное как оболочка для модуля SymPy (модуль Python для оперирования с математическими абстракциями и выполнения как символьных так и численных вычислений).
Цель написания приложения состоит в создании простого калькулятора, который имеет клавиатурный ввод (плюс вставка из буфера обмена «копи-паст») и заодно работает с символьными переменными.
Для описания использования, см. файл help_rus.txt

Автор: А. В. Силантьев

Версия: 3.0

## Файлы:
```plaintext
.
├── core
│   ├── graph.py            — функции для первичного парсинга строки в вычислительный граф
│   ├── symbolic.py         — класс для перевода в sympy-выражения
│   ├── calculator.py       — класс-калькулятор
│   ├── logger.py           — логирование
│   ├── session_storage.py  — сохранение состояния
│   └── help_rus.txt        — текст с инструкцией использования
├── web
│   ├── api_service.py      — web-сервис калькулятора
│   ├── pyd_models.py       — pydantic-модели для сервиса
│   ├── calc_client.py      — клиент-калькулятор для взаимодействия с сервисом
│   └── run_client.py       — запуск клиента
├── console
│   ├── console_calc.py     — консольная версия калькулятора
│   ├── console_app.py      — запуск консольной версии
│   └── console_client.py   — запуск консольной версии как клиента
├── gui
│   ├── minigui.py          — мини-графическая версия калькулятора
│   ├── qt_classes.py       — вспомогательный модуль для графической версии
│   ├── minigui_app.py      — запуск мини-графической версии
│   └── minigui_client.py   — запуск мини-графической версии как клиента
├── telegram
│   ├── bot.py              — сервис для телеграм-бота (требуется токен)
│   └── mytoken.py          — здесь секретный токен: TOKEN = ...
├── Dockerfile              (используется для создания образа консольной версии)
├── LICENSE
├── README.md
├── requirements.txt
├── requirements_full.txt
├── requirements_console_calc.txt
├── symcalc.py              — запуск (mini)-gui/консольной версии
├── run_symcalc.sh          — скрипт для запуска (mini)-gui/консольной версии
├── run_client.sh           — скрипт для запуска клиента
├── run_telegram_bot.sh       — скрипт для запуска телеграм бота
└── run_web_service.sh      — скрипт для запуска сервиса
```

Полная графическая версия находится в разработке

Мой телеграм бот: https://t.me/SymbolicCalculator_bot

Используемые (прямым импортом) библиотеки:

 - Требуемые: sympy==1.11.1, PyQt5==5.15.7, simple_term_menu==1.6.1, pyTelegramBotAPI==4.12.0, fastapi==0.116.1, uvicorn==0.35.0

 - Зависимые: pydantic==2.11.7 (от fastapi), requests==2.32.4 (от pyTelegramBotAPI)

Полный список всех библиотек см. в файле `requirements_full.txt`.

## Установка

Скачать с github или клонировать через git:
```
git clone git@github.com:silantjev/Symbolic-Calculator.git
cd Symbolic-Calculator/
```

Для установки Python см. https://www.python.org/downloads/

Рекомендуется использовать Python 3.10 и виртуальное окружение

На ubuntu:
```bash
sudo apt-get install python3.10==3.10.18-1+focal1
python3.10 -m venv ".venv"
source ".venv/bin/activate"
```

Также необходимо установить модули:
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

Для работы telegram-бота необходимо создать файл `telegram/mytoken.py` и указать там токен (см. ниже).

## Запуск
Для запуска можно использовать bash-скрипты, находящиеся в корне.
Скрипты активируют виртуальное окружение .venv автоматически.

### монолитный вариант
Запустить без использования клиент-сервисной системы можно командой
```bash
./run_symcalc.sh [-m] [-c] [-l] [-f]
```
со следующими опциями:

 - "`-m`" — mini-gui-версия (по умолчанию)
 - "`-c`" — консольная версия
 - "`-l`" — логирование в консоль (для дебага)
 - "`-f`" — логирование в файл в папке `logs/` (для дебага)

### клиент-сервисный вариант
Так же можно использовать клиент-сервисную систему:

 - один раз запускается сервер:
```bash
./run_web_service.sh [-l] [-f] [-p CONF_PATH] [--host HOST] [--port PORT] [--reload]
```
 - когда нужно запускается клиент:
```bash
./run_client.sh [-m] [-c] [-l] [-f] [--host HOST] [--port PORT]
```
с теми же HOST и PORT

### telegram-вариант
Ещё есть версия в виде telegram-бота. Для её использования нужно создать бот в telegram. Прописать секретный токен этого бота строчкой вида
```py
TOKEN = 'my-sectet-token'
```
в файл `telegram/mytoken.py`. Затем запустить бот-сервис командой
```bash
./run_telegram_bot.sh [-l] [-f]
```

## Команды для docker:

 - Создание образа:
```bash
docker build -t ccalc_image .
```
 - Запуск:
```bash
docker run -it --rm --name ccalc ccalc_image
```
 - Остановка:
```bash
docker stop ccalc
```
